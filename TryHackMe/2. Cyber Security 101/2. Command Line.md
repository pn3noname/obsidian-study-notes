source: https://tryhackme.com/room/windowscommandline

---

## 1. Windows Command Line

1. Basic System Information
	1. `set`
		- MS Windows가 명령어를 실행할 경로 (`Path=`로 시작하는 줄)
			![[Pasted image 20250712142342.png]]

	2. `ver` -> Mac: `sw_vers`
		- 운영 체제 (OS) 버전 확인
			![[Pasted image 20250712144839.png]]

	3. `systeminfo` -> Mac: `system_profiler`
			![[Pasted image 20250712145003.png]]
		- OS 정보, 시스템 세부사항, 프로세서 및 메모리 등 시스템에 대한 다양한 정보

	4. `driverquery | more`
			![[Pasted image 20250712145540.png]]
		- 출력이 너무 길 경우 `more`를 통해 파이프할 수 있음 (스페이스바 버튼을 눌러 페이지별로 볼 수 있음)

2. Network Troubleshooting
	1. Network Configuration (네트워크 구성)
		- `ipconfig`를 사용하여 네트워크 정보를 확인할 수 있음 -> Mac: `ifconfig`
		- `ipconfig /all`을 사용하여 네트워크 구성에 대한 더 자세한 정보를 볼 수 있음 (DNS 서버를 확인하고 DHCP가 활성화되어 있는지 확인 가능)
			![[Pasted image 20250712174252.png]]
		- Which command can we use to look up the server’s physical address (MAC address)? -> ipconfig /all

	2. Network Troubleshooting
		1. `ping target_name`
			- 일반적인 문제 해결 작업 중 하나는 서버가 인터넷상의 특정 서버에 접근할 수 있는지 확인하는 것
			- ex: `ping example.com`
			- 특정 ICMP 패킷을 보내고 응답을 기다리며, 응답이 수신되면 대상에 도달할 수 있고, 대상도 우리에게 도달할 수 있다는 것을 알 수 있음

		2. `tracert target_name` -> Mac: `traceroute target_name`
			- trace route의 줄임말
			- ex: `tracert google.com`
			- 대상에 도달하기 위해 경유하는 네트워크 경로를 추적함
			- 경로상의 라우터들이 패킷의 TTL (Time-To-Live)이 0에 도달하여 패킷을 폐기할 때 우리에게 알려주기를 기대함
			- 명령어 입력 후, 터미널 출력에서는 목표에 도달하기 전에 n개의 라우터를 통과했음을 보여줌
				![[Pasted image 20250712175923.png]]

	3. More Networking Commands
		1. `nslookup `
			- 호스트나 도메인을 조회하여 IP주소를 반환함
			- `nslookup example.com`: 기본 네임 서버를 사용하여 example.com을 조회
			- `nslookup example.com 1.1.1.1`: 1.1.1.1 네임 서버를 사용함
				![[Pasted image 20250712180255.png]]

		2. `netstat`
			- 현재 네트워크 연결과 수신 대기 중인 포트를 표시함
			- 인수 없이 사용하는 기본 `netstat`
				![[Pasted image 20250713141123.png]]
			- 위의 예의 경우, SSH 연결이 하나만 있으며, 포트 22에 바인딩되어 있어 SSH임을 알 수 있음
			- 다른 옵션들:
				- `netstat -h`: 도움말 페이지
				- `netstat -a`: 모든 설정된 연결과 수신 대기 중인 포트 표시
				- `netstat -b`: 각 수신 대기 포트 및 설정된 연결과 연관된 프로그램을 표시
				- `netstat -o`: 연결과 연관된 프로세스 ID (PID)를 표시
				- `netstat -n`: 주소와 포트 번호에 대해 숫자 형식을 사용
			- ex:
				![[Pasted image 20250713141752.png]]
				- 위의 예의 첫 번째 줄에서 보여주는 것처럼 실팽 파일 `sshd.exe`가 포트 22에서 들어오는 연결을 수신 대기하는 역할을 담당
				- 각 연결과 연관된 프로세스 ID (PID)도 확인 가능

> [!INFO]
> ### DHCP (Dynamic Host Configuration Protocol)
> - 네트워크에 연결된 장치들에게 자동으로 IP 주소와 네트워크 설정을 배정해주는 프로토콜
> #### 1.DHCP의 역할
> - 자동 IP 주소 할당: 컴퓨터, 스마트폰, 태블릿 등이 네트워크에 연결될 때 자동으로 사용 가능한 IP 주소를 찾아서 할당해 줌
> - 네트워크 설정 제공: IP 주소 외에도 서브넷 마스크, 게이트웨이 주소, DNS 서버 주소 등 네트워크에 접속하기 위해 필요한 모든 정보를 함께 제공함
> - IP 주소 관리: 사용하지 않는 IP 주소를 회수하고 재사용할 수 있도록 관리함
> #### 2. 쉬운 비유
> - DHCP를 호텔의 프런트 데스크에 비유할 수 있음. 손님(장치)이 호텔(네트워크)에 도착하면, 프런트 데스크 직원(DHCP 서버)이 빈 방(IP 주소)을 찾아서 열쇠와 함께 호텔 이용 안내서(네트워크 설정)를 제공해줌. 손님이 체크아웃하면 그 방은 다시 다른 손님이 사용할 수 있게 됨
> #### 3. DHCP가 없다면?
> - DHCP가 없다면 네트워크 관리자가 모든 장치에 수동으로 IP 주소를 설정해야 하고, IP 주소 충돌을 방지하기 위해 어떤 주소가 사용 중인지 계속 추적함 (이는 매우 번거롭고 실수가 발생하기 쉬운 작업)
> - 일반적으로 가정용 공유기나 회사의 네트워크 장비에 DHCP 서버 기능이 내장되어 있어서, 우리가 와이파이에 연결할 때 자동으로 인터넷을 사용할 수 있는 것

> [!INFO]
> ### ICMP (Internet Control Message Protocol)
> - 네트워크에서 오류나 상태 정보를 전달하는 프로토콜
> #### 1. ICMP의 기본 개념
> - ICMP는 IP 프로토콜의 보조 역할을 하는 프로토콜
> - 데이터 전송 자체보다는 네트워크 상태를 점검하고 문제를 알려주는 역할을 함
> - 마치 우편 시스템에서 "배달 불가" 스티커를 붙여 돌려보내는 것과 비슷함
> #### 2. 주요 역할
> - 오류 메시지 전달: 패킷이 목적지에 도달할 수 없거나, 전송 중 문제가 생겼을 때 송신자에게 알려줌. 예를 들어 "목적지에 도달할 수 없음", "시간 초과", "포트가 닫혀있음" 같은 정보를 전달
> - 네트워크 진단: ping 명령어가 대표적인 예시. ping은 ICMP Echo Request를 보내고 Echo Reply를 받아서 네트워크 연결 상태와 응답 시간을 확인함
> - 경로 추적: traceroute 명령어에서 사용되어 패킷이 목적지까지 어떤 경로를 거쳐가는지 확인할 수 있음
> #### 3. 실생활 비유
> - ICMP를 우편 시스템에 비유하면, 편지(데이터 패킷)를 보낼 때 우체국(라우터)에서 "주소 불명으로 배달 불가", "수신인 부재" 같은 메모를 붙여 돌려보내는 것과 같음
> - 또한 "잘 도착했는지 확인해줘"라고 요청하면 "잘 받았어"라고 답장을 보내주는 역할도 함
> - ICMP는 네트워크 관리자가 네트워크 문제를 진단하고 해결하는 데 필수적인 도구이며, 일반 사용자도 인터넷 연결 상태를 확인할 때 간접적으로 사용하게 됨

3. File and Disk Management
	1. Working with Directories
		- 매개변수 없이 `cd` 명령을 사용하여 현재 드라이브와 디렉토리 표시할 수 있음
		- `dir` 명령을 사용하여 하위 디렉토리를 볼 수 있음
			![[Pasted image 20250713232927.png]]
		- `dir` 명령에서 사용할 수 있는 옵션들:
			- `dir /a`: 숨겨진 파일과 시스템 파일도 표시
			- `dir /s`: 현재 디렉토리와 모든 하위 디렉토리의 파일을 표시
		- `tree` 명령을 입력하여 하위 디렉토리와 서브디렉토리를 시각적으로 표현할 수 있음
			![[Pasted image 20250713233135.png]]
		- `rmdir directory_name`: 디렉토리 삭제
			![[Pasted image 20250713233326.png]]

	2. Working with Files
		- `type`: 명령줄로 작업할 때 특정 텍스트 파일의 내용을 확인할 수 있음 (더 긴 텍스트 파일의 경우 `more` 명령)
		- `copy`: 파일을 한 위치에서 다른 위치로 복사할 수 있음
			![[Pasted image 20250713233642.png]]
		- `move`: 파일 이동
			![[Pasted image 20250713233758.png]]
		- `del` or `erase`: 파일 삭제
		- `*` (와일드카드 문자): 여러 파일을 참조할 수 있음
			- ex: `copy *.md C:\Markdown` -> 확장자가 md인 모든 파일을 C:\Markdown 디렉토리로 복사

4. Task and Process Management
	1. 실행 중인 프로세스 목록 확인
		- `tasklist`: 실행 중인 프로세스 나열
			![[Pasted image 20250713235006.png]]

	2. 프로세스 필터링
		- 위의 예와 같이 출력이 매우 길 것으로 예상될 땐 필터링이 유용함
		- `tasklist /?`: 도움말 페이지를 표시하면 사용 가능한 모든 필터 확인 가능
		- ex: `sshd.exe`와 관련된 작업 검색 -> `tasklist /FI "imagename eq sshd.exe`
			- `/FI`: 필터를 설정하는 데 사용됨
			![[Pasted image 20250713235347.png]]

	3. 프로세스 종료
		- 프로세스 ID (PID)를 알면 명령어를 사용하여 작업 종료 가능
		- `taskkill /PID target_pid`
		- ex: `taskkill /PID 4567`

> [!TIP]
> ### 추가적인 명령어
> - `chkdsk`: 파일 시스템과 디스크 볼륨의 오류 및 배드 섹터를 검사
> - `driverquery`: 설치된 장치 드라이버 목록 표시
> - `sfc /scnanow`: 시스템 파일의 손상을 스캔하고 가능한 경우 복구
> - `shutdown /r`: The command `shutdown /s` can shut down a system. What is the command you can use to restart a system?
> - `shutdown /a`: What command can you use to abort a scheduled system shutdown?

---

## 2. Windows PowerShell

1. PowerShell이란?
	- PowerShell은 작업 자동화와 구성 관리를 위해 Microsoft에서 개발한 강력한 도구
	- `.NET framework`를 기반으로 구축된 명령줄 인터페이스와 스크립팅 언어를 결합한 것
	- 기존의 텍스트 기반 명령줄 도구들과 달리, PowerShell을 객체 지향적이어서 복잡한 데이터 유형을 처리하고 시스템 구성 요소와 더 효과적으로 상호작용할 수 있음
	- 처음에는 Windows 전용이었지만, 최근 macOS와 Linux를 지원하도록 확장됨

2. PowerShell의 간략한 역사
	- PowerShell은 Windows에서 기존 명령줄 도구와 스크립팅 환경의 한계를 극복하기 위해 개발됨
	- 2000년대 초, Windows가 복잡한 기업 환경에서 점점 더 많이 사용되면서, `cmd.exe`와 배치 파일 같은 전통적인 도구들은 이러한 시스템을 자동화하고 관리하는 데 한계를 드러냄
	- Microsoft는 더 정교한 관리 작업을 처리하고 Windows의 현대적인 API와 상호작용할 수 있는 도구가 필요했음
	- Microsoft 엔지니어인 Jeffrey Snover는 Windows와 Unix가 시스템 운영을 다르게 처리한다는 것을 깨달음
	- Windows는 구조화된 데이터와 API를 사용하는 반면, Unix는 모든 것을 텍스트 파일로 처리
	- 이러한 차이점으로 인해 Unix 도구를 Windows에 이식하는 것이 비실용적이었음
	- Snover의 해결책은 스크립팅의 단순함과 .NET 프레임워크의 강력함을 결합한 `object-oriented approach (객체 지향적 접근 방식)`을 개발하는 것이었음
	- 2006년에 출시된 PowerShell은 관리자들이 객체를 조작하여 작업을 더 효과적으로 자동화할 수 있게 해주었으며, Windows 시스템과의 더 깊은 통합을 제공했음

3. PowerShell의 힘
	- 이에 대해 완전히 이해하려면, 먼저 이 맥락에서 `object (객체)`가 무엇인지 이해해야 함
	- 프로그래밍에서 **객체**는 `properties (characteristics); 속성 (특성)`과 `methods; 메서드 (동작)를 가진 항목을 나타냄
	- ex: `자동차` 객체는 `색상`, `모델`, `연료량`과 같은 속성을 가질 수 있고, `운전하기()`, `경적울리기()`, `급유하기()`와 같은 메서드를 가질 수 있음
	- 마찬가지로, PowerShell에서 객체는 데이터와 기능을 캡슐화하는 기본 단위로, 정보를 관리하고 조작하는 것을 더 쉽게 만듦
	- PowerShell의 객체는 파일 이름, 사용자 이름 또는 크기를 데이터(**속성**)로 포함할 수 있고, 파일 복사나 프로세스 중지와 같은 기능(**메서드**)을 수행할 수 있음
	- 전통적인 명령 셸의 기본 명령들은 텍스트 기반이며, 이는 데이터를 평문 텍스트로 처리하고 출력한다는 의미
	- 반면, PowerShell에서 `cmdlet (command-let으로 발음)`이 실행될 때, 이는 속성과 메서드를 유지하는 객체를 반환함
	- 이러한 객체들은 추가적인 텍스트 파싱이 필요하지 않기 때문에 더 강력하고 유연한 데이터 조작을 가능하게 함

4. PowerShell Basics
	- Remmina 클라언트를 사용하여 SSH로 대상 VM 연결

	1. Launching PowerShell
		1. GUI에서 실행하는 방법
			- 시작 메뉴: Windows 시작 메뉴 검색창에 `powershell` 입력 -> Windows PowerShell 또는 PowerShell 클릭
			- 실행 대화상자: `Win + R` -> `powershell` 입력 -> Enter
			- 파일 탐색기: 원하는 폴더로 이동 -> 주소 표시줄에 `powershell` 입력 -> Enger (해당 디렉토리에서 PowerShell 열림)
			- 작업 관리자: 작업 관리자 열기 -> 파일 > 새 작업 실행 -> `powershell` 입력 -> Enter
		
		2. Command Prompt에서 실행
			- `cmd.exe`에서 `powershell` 입력 후 Enter













































