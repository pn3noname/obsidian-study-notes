source: https://tryhackme.com/room/networkingconcepts

---

## 1. Networking Concepts

1. OSI Model
	- Open Systems Interconnection
	- 국제표준화기구 (ISO)에서 개발한 개념적 모델로, 컴퓨터 네트워크에서 통신이 어떻게 발생해야 하는지를 설명함
	- 즉, OSI 모델은 컴퓨터 네트워크 통신을 위한 framework를 정의함
	- `Please Do Not Throw Spinach Pizza Away` (PDNTSPA)

	1. OSI Model의 7 layers
		1. Layer 1: Physical Layer (물리 계층)
			- 장치 간의 물리적 연결
			- 전선과 같은 매체와 이진 숫자 0과 1의 정의를 포함함
			- 데이터 전송은 전기적, 광학적, 또는 무선 신호를 통해 이루어짐
			- ex: 전선, 광케이블, 이더넷 케이블, 무선 허브, 리피터, 동축 케이블, WiFi 무선 대역, 2.4GHz 대역, 5GHz 대역, 6GHz 대역

		2. Layer 2: Data Link Layer (데이터 링크 계층)
			- 같은 네트워크 세그먼트의 두 노드들 간에 신뢰성 있는 데이터 전송을 가능하게 하는 프로토콜 (같은 네트워크 세그먼트의 다른 시스템들 간에 통신하는 방법에 대한 합의)
			- 네트워크 세그먼트는 정보 전송을 위해 공유 매체나 채널을 사용하는 네트워크 장치들의 그룹
			- ex: Ethernet (802.3), WiFi (802.11), PPP, ATM, Frame Relay
				![[Pasted image 20250716194422.png]]
					(source: https://tryhackme.com/room/networkingconcepts)
			- 이더넷과 WiFi 주소는 6바이트이며, 이들의 주소는 MAC 주소라고 불림
			- MAC은 Media Access Control을 의미
			- 이들은 보통 16진수 형식 (hexadecimal digits)으로 표현되며, 콜론으로 각 두 16진수 숫자 (1바이트)를 구분함
			- MAC 주소는 6개의 Octet or 바이트로 구성되며, 왼쪽 3바이트는 제조업체를 식별 (Octet이란 IP주소를 이진법으로 변환하여 8개씩 나눈 비트 단위)
			- 즉, 데이터 링크 계층에서는 MAC 주소를 사용하여 프레임을 전송
			- 이더넷이나 WiFi를 통한 실제 네트워크 통신에서는 각 프레임에 두 개의 MAC 주소가 있을 것으로 예상됨
				![[Pasted image 20250716195022.png]]
				- 노란색: 목적지 데이터 링크 MAC 주소
				- 파란색: 소스 데이터 링크 MAC 주소
				- 나머지 비트들은 전송되는 데이터를 보여줌

		3. Layer 3: Network Layer (네트워크 계층)
			- 서로 다른 네트워크 간의 경로를 설정하고 데이터를 라우팅하는 계층
			- 논리적 주소 지정과 라우팅, 즉 다양한 네트워크 간에 네트워크 패킷을 전송할 경로는 찾는 것을 처리함
			- 차이점
				- 데이터 링크 계층: 10대의 컴퓨터가 있는 한 회사 사무실의 10대의 컴퓨터 연결
				- 네트워크 계층: 뉴욕 지사의 사무실과 싱가폴의 사무실 네트워크 연결
			- ex: IP (인터넷 프로토콜), ICMP (인터넷 제어 메시지 프로토콜), VPN (가상 사설망; IPSec, SSL/TLS VPN...), ARP, RARP, OSPF, BGP

		4. Layer 4: Transport Layer (전송 계층)
			- 다른 호스트에서 실행되는 응용 프로그램 간의 종단 간 (end-to-end) 신뢰성 있는 통신/데이터 전송을 가능하게 함
			- 오류 검출 및 수정, 흐름 제어, 재전송, 세그멘테이션 등을 통해 데이터의 무결성 보장
			- ex: TCP (전송 제어 프로토콜), UDP (사용자 데이터그램 프로토콜), SCTP, SPX

		5. Layer 5: Session Layer (세션 계층)
			- 다른 호스트에서 실행되는 응용 프로그램 간의 통신을 설정, 유지, 동기화하는 계층
			- 세션 설정의 의미: 응용 프로그램 간의 통신을 시작하고 세션에 필요한 매개변수를 협상하는 것
			- 대화 제어와 동기화를 담당하는데, 테이터 동기화는 데이터가 올바른 순서로 전송되도록 보장하고 전송 실패 시 복구를 위한 메커니즘을 제공함
			- ex: NFS (네트워크 파일 시스템), RPC (원격 프로시저 호출), NetBIOS, SQL, SMB

		6. Layer 6: Presentation Layer (표현 계층)
			- 데이터 형식을 변환하고 암호화, 압축을 담당하는 계층
			- 즉, 데이터가 7단계인 응용 계층이 이해할 수 있는 형태로 전달되도록 보장함
			- 데이터 인코딩, 압축, 암호화를 처리
			- 이메일을 보낼 때 파일을 이메일에 첨부하기 위해 MIME (다목적 인터넷 메일 확장)을 사용하는데, 이는 7비트 ASCII 문자를 사용해 바이너리 파일을 인코딩함
			- ex: JPEG, GIF, MPEG, ASCII, EBCDIC, SSL/TLS

		7. Layer 7: Application Layer (응용 계층)
			- 최종 사용자 으용 프로그램에 직접 네트워크 서비스 제공함
			- 웹 브라우저가 HTTP 프로토콜을 사용해 파일을 요청하거나, 폼을 제출, 파일을 업로드함
			- ex: HTTP, HTTPS, FTP, DNS, POP3, SMTP, IMAP, DHCP

	2. Summary
		![[Pasted image 20250716201715.png]]
			(source: https://tryhackme.com/room/networkingconcepts)
		![[Pasted image 20250716201745.png]]

2. TCP / IP Model
	- TCP / IP는 Transmission Control Protocol / Internet Protocol (전송 제어 프로토콜 / 인터넷 프로토콜)
	- 1970년대 국방부 (DoD)에 의해 개발됨
	- 이 모델의 강점 중 하나가 네트워크의 일부가 서비스 불능 상태가 되더라도 네트워크가 계속 작동할 수 있다는 점 (네트워크 topology가 변경될 때 적응하도록 설계된 라우팅 프로토콜의 설계 덕분에 가능함)
		![[Pasted image 20250716222340.png]]
	- 전통적인 TCP / IP 4계층 모델과 현대적인 5계층 모델이 있음

3. IP Addresses and Subnets
	1. IP 주소란?
		- 네트워크상의 모든 호스트는 다른 호스트들이 통신하기 위해 고유한 식별자 (Unique identifier)가 필요함
		- TCP / IP protocol suite를 사용할 때, 네트워크에 연결된 각 기기마다 IP 주소를 할당해야 함
		- IP 주소에는 IPv4와 IPv6가 있음
		- IPv4가 여전히 가장 일반적임

	2. IP 주소의 구성
		- IP 주소는 4개의 octet (또는 바이트)으로 구성되어 총 32비트
		- 8비트인 octet은 0과 255 사이의 십진수를 나타낼 수 있음
		- 예를 들면, `192.168.1.0`은 네트워크 주소이고 `192.168.1.255`는 브로드캐스트 주소 (Broadcast Address; 특정 네트워크 대역 내의 모든 장치에 데이터를 동시에 전송하는 데 사용되는 특별한 IP 주소. 즉, 해당 네트워크에 연결된 모든 장비가 이 주소로 전송된 데이터를 받을 수 있음.)

	3. Network Configuration
		- MS Windows 명령줄: `ipconfig` 명령을 사용하여 IP 주소를 확인할 수 있음
		- Linux & UNIX: `ifconfig` or `ip address show` or `ip a s`
		- `ifconfig`
			![[Pasted image 20250716224933.png]]
			- 호스트 (노트북) IP 주소: 192.168.66.89
			- 서브넷 마스크: 255.255.255.0
			- 브로드캐스트 주소: 192.168.66.255

		- `ip a s`
			![[Pasted image 20250716225456.png]]
			- 호스트 (노트북) IP 주소: 192.168.66.89/24
			- 브로트캐스트 주소: 192.168.66.255
			
			- 255.255.255.0의 서브넷 마스크는 `/24`로도 쓸 수 있음
			- `/24`는 IP 주소 내의 왼쪽 24비트가 네트워크 전체에서 변하지 않는다는 의미
			- 즉, 왼쪽 세 옥텟이 전체 서브넷에서 동일하므로, 192.168.66.1부터 192.168.66.254까지의 주소 범위를 찾을 수 있음 (192.168.66.0은 네트워크 주소, 192.168.66.255는 브로드캐스트 주소)

	4. Private Addresses
		- 실용적인 목적으로 두 가지 유형의 IP 주소가 있음
			- Public IP addresses
			- Private IP addresses
		- RFC 1918은 다음 세 가지 사설 IP 주소 범위를 정의함 (암기할 것)
			- 10.0.0.0 - 10.255.255.255 (10/8)
			- 172.16.0.0 - 172.31.255.255 (172.16/12)
			- 192.168.0.0 - 192.168.255.255 (192.168/16)
		- 공인 IP 주소와는 달리, 사설 IP 주소는 격리된 도시나 복합 단지와 같아서, 모든 집과 아파트가 체계적으로 번호가 매겨져 있고 서로 쉽게 우편을 교환할 수 있지만, 외부 세계와는 그렇지 않음
		- 사설 IP 주소가 인터넷에 접근하려면, 라우터가 공인 IP 주소를 가져야 하고 네트워크 주소 변환 (NAT)을 지원해야 함

	5. Routing
		- 라우터는 지역 우체국과 비슷한 개념
		- 라우터는 적절한 네트워크로 데이터 패킷을 전달함
		- 보통 데이터 패킷은 최종 목적지에 도달하기 전에 여러 라우터를 거침
		- 라우터는 3계층에서 기능하며, IP 주소를 검사하고 패킷이 목적지에 더 가까워지도록 최적의 네트워크 (라우터)로 패킷을 전달함

> [!INFO]
> ### Subnet Mask
> #### 1. 서브넷 마스크란?
> - IP 주소에서 "어디까지가 네트워크 부분이고, 어디부터가 호스트 부분인지"를 구분해주는 도구
> #### 2. 예시
> - IP 주소: 192.168.1.100
> - 네트워크 부분: 192.168.1 -> 아파트 단지 주소
> - 호스트 부분: 100 -> 아파트 호수
> #### 3. 실제 예시
> ##### 1. 255.255.255.0 (또는 /24)
> - IP 주소: **192.168.1.100**
> - 서브넷 마스크: **255.255.255.0**
> - 의미: 앞의 3개 숫자(192.168.1)는 네트워크, 마지막 1개 숫자(100)는 호스트
> - 같은 네트워크 범위: 192.168.1.1 ~ 192.168.1.254
> ##### 2. 255.255.0.0 (또는 /16)
> - IP 주소: **192.168.1.100**
> - 서브넷 마스크: **255.255.0.0**
> - 의미: 앞의 2개 숫자(192.168)는 네트워크, 뒤의 2개 숫자(1.100)는 호스트
> - 같은 네트워크 범위: 192.168.0.1 ~ 192.168.255.254
> #### 4. 서브넷 마스크가 필요한 이유
> 1. 같은 네트워크 찾기: 컴퓨터가 "이 IP 주소가 같은 네트워크에 있나"를 판단
> 2. 라우팅 결정: 같은 네트워크면 직접 통신, 다른 네트워크면 라우터 거쳐서 통신
> 3. 네트워크 분할: 큰 네트워크를 작은 네트워크로 나누기

4. UDP and TCP
	- IP 프로토콜은 네트워크상의 목적지 호스트에 도달할 수 있도록 해 줌
	- 이 호스트는 IP 주소로 식별됨
	- 네트워크에 연결된 호스트 내의 프로세스 간 통신을 가능하게 하려면 전송 계층 (Transport Layer) 프로토콜이 필요함 => 두 가지 전송 프로토콜: UDP & TCP

	1. UDP (User Datagram Protocol)
		- UDP는 대상 호스트의 특정 프로세스에 도달할 수 있도록 해주는 간단한 비연결형 (connectionless) 전송 계층 (4계층) 프로토콜
		- 비연결형이라는 것은 데이터를 보내기 전에 연결을 설정할 필요가 없다는 의미
		- 전송된 패킷이 도착했는지 여부조차 확인할 방법이 없음
		- IP 주소는 호스트를 식별하지만, port number를 사용함으로써 송신 및 수신 프로세스를 식별할 수 있음
			- 포트 번호는 2바이트 (16비트)이며, 범위는 1~65535 (0번 포트는 예약되어 사용되지 않음)
			- 65535는 2¹⁶ − 1의 결과
		- UDP는 배송 확인이 없는 일반 우편 서비스
		- 즉, 패킷이 수신되었는지 보장하지 않으며, 저렴한 비용과 빠른 속도가 장점
		- 하지만 확실한 데이터 수신이 필요한 경우, 더 신뢰성 있는 프로토콜이 필요함 => TCP

	2. TCP (Transmission Control Protocol)
		- 연결지향형 (connection-oriented)의 전송 계층 (4계층) 프로토콜
		- UDP와 달리, 데이터의 신뢰성과 정확한 전달을 보장하기 위한 여러 메커니즘을 사용함
		- 데이터를 보내기 전 반드시 TCP 연결을 먼저 설정
		- TCP는 전송하는 각 데이터 바이트에 시퀀스 번호 (순서 번호)를 부여함
			- 수신 측은 이 번호를 통해 중복되거나 손실된 데이터를 판별할 수 있음
			- 수신 측은 ACK (확인 응답) 번호로 수신을 알려주며, 이는 마지막으로 잘 받은 바이트의 번호를 포함함
		- TCP 연결 수립 과정: 3-way Handshake
			- `SYN (동기화)`와 `ACK (확인 응답)` 플래그가 사용됨
			1. `SYN 패킷`: 클라이언트가 연결을 시작하며, SYN 패킷을 서버로 전송. 이 패킷은 클라이언트가 무작위로 선택한 초기 시퀀스 번호를 포함함
			2. `SYN-ACK 패킷`: 서버는 응답으로 `SYN-ACK 패킷`을 클라이언트에게 전송. 이때 서버도 자신의 초기 시퀀스 번호를 포함함
			3. `ACK 패킷`: 클라이언트가 `ACK 패킷`을 보내어 `SYN-ACK의 수신`을 확인함으로써 핸드쉐이크가 완료되고 연결이 설정됨
		- UDP와 유사하게, TCP는 포트 번호를 사용하여 연결을 시작하거나 대기 (리스닝)하는 과정을 식별함
		- 유효한 포트 번호는 1~65535 사이 (두 개의 octets을 사용하고, 포트 0은 예약되어 있기 때문)

5. Encapsulation
	- 각 계층이 수신된 데이터 단위에 Header (때로는 trailer도)를 추가하여 캡슐화된 단위를 아래 계층으로 전송하는 과정을 의미함
	- 캡슐화는 각 계층이 자신의 고유한 기능에 집중할 수 있게 해주는 필수적인 개념
	- 4단계
		- Application data
			- 사용자가 전송하고자 하는 데이터를 애플리케이션에 입력할 때 모든 것이 시작됨
			- ex: 이메일을 작성하거나 인스턴트 메시지를 입력하고 전송 버튼을 누르는 것
			- 애플리케이션은 이 데이터를 형식화하고 사용되는 애플리케이션 프로토콜에 따라 하위 계층인 전송 계층을 사용하여 전송을 시작함
		- Transport protocol segment or datagram
			- TCP 또는 UDP와 같은 전송 계층은 적절한 헤더 정보를 추가하여 TCP segment (or UDP datagram)를 생성함
			- 이 세그먼트는 하위 계층인 네트워크 계층으로 전송됨
		- Network packet
			- 네트워크 계층, 즉 인터넷 계층은 수신된 TCP 세그먼트 또는 UDP 데이터그램에 IP 헤더를 추가함
			- 그러면 이 IP 패킷이 하위 계층인 데이터 링크 계층으로 전송됨
		- Data link frame
			- 이더넷 또는 WiFi가 IP 패킷을 수신하고 적절한 헤더와 트레일러를 추가하여 프레임을 생성함
































